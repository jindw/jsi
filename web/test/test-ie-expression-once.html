<!doctype>
<html>
<head>

<style>
</style>
</head>
<body>
<textarea id="output" style="width:100%;height:700px;font-size:11px;" ondblclick="eval(this.value)"></textarea>
<li id="pre" class="pre">aa</li>
<script>
var inc = 1;
var afterCountMap = {};
var totalCountMap = {};
var end = false;
var show = true;
function clear(el,key){
	var end = arguments.length;
	
	for(var i=2;i<end;i++){
	var value = arguments[i];
	try{
		el.style[key] = value;	
	}catch(e){show && (show = confirm(key))
	}
	try{
		el.runtimeStyle[key] = value;	
	}catch(e){show && (show = confirm(key))
	}
	}
}
var defaultMap = {}
function test(el,key){
	key = key.replace(/\-(\w)/g,function(a,c){return c.toUpperCase()});
	var v = totalCountMap[key];
	//setTimeout(function(){
		if(!v){
			v = totalCountMap[key] = 1;
			try{
				var value = el.parentNode.currentStyle[key];
				defaultMap[key]=value
				el.runtimeStyle.setAttribute(key,value)
				el.style[key] = value;	
				if(key.indexOf('Kashida')>0){
					//alert([key,value])
				}
			}catch(e){
				//show && (show = confirm("!"+key+e.message))
			}
			//clear(el,key ,'inherit');
			//,''
			//,'none','default','ih','repeat','inherit'
			//)
		}
	//},1);
	if(inc<1000){
		inc++;
		return;
	}
	if(inc++>3650){
		if(end){return}end  = true;
		var buf = [];
		for(var n in totalCountMap){
			buf.push([afterCountMap[n]||0,totalCountMap[n],n,defaultMap[n]]);
		}
		try{
		buf.sort(function(a,b){
			return a[0]-b[0];
		});
		}catch(e){alert(e).message}
		output.value =  buf.join('\r\n;');
		return;
	}
	totalCountMap[key] = v &&( v+1) ||1;
	
	var v = afterCountMap[key];
	if(inc>2000){
		afterCountMap[key] = v &&( v+1) ||1;
	}
	return '';
}
var list = [
"text",
"text-underline",
"text-kashida",
"ime","layout",
"letter","line","min","ruby",
"unicode","vertical","white","word","writing",
"scrollbar",
"table","page","page-break",
"scrollbar-3dlight",
"scrollbar-arrow",
"scrollbar-base",
"scrollbar-darkshadow",
"scrollbar-face",
"scrollbar-highlight",
"scrollbar-shadow",
"z",
"pagex",
"layout",
"behavior",
"direction",
"direction", 
/*
"font", 
"font-family", 
"font-size", 
"font-style", 
"font-variant", 
"font-weight", 
"ime-mode",
"min-height",
"line-height", 
"ruby-align",
"ruby-overhang",
"ruby-position",
*/
"layout-grid",
"layout-grid-char",
"layout-grid-line",
"layout-grid-mode",
"layout-grid-type",
"letter-spacing", 
"line-break",

"text-underline-position",
"unicode-bidi", 
"white-space",
"word-break",
"word-spacing", 
"word-wrap",
"writing-mode",
"text-autospace",
/*

"text-align", 
"text-decoration", 
"text-indent", 
"text-overflow", 
"text-transform", 
"vertical-align", 

"background-attachment", 
"background-color", 
"background-image", 
"background-position", 
"background-position-x",
"background-position-y",
"background-repeat", 
"color", 
"border", 
"border-bottom", 
"border-bottom-color", 
"border-bottom-style", 
"border-bottom-width", 
"border-collapse",
"border-color", 
"border-left", 
"border-left-color", 
"border-left-style", 
"border-left-width", 
"border-right", 
"border-right-color", 
"border-right-style", 
"border-right-width", 
"border-style", 
"border-top", 
"border-top-color", 
"border-top-style", 
"border-top-width", 
"border-width", 
"clear", 
"float", 
"margin", 
"margin-bottom", 
"margin-left", 
"margin-right", 
"margin-top", 
"padding", 
"padding-bottom", 
"padding-left", 
"padding-right", 
"padding-top", 
"zoom",
"display", 
"list-style", 
"list-style-image", 
"list-style-position", 
"list-style-type", 
"bottom",
"clip", 
"height", 
"left", 
"overflow", 
"overflow-x",
"overflow-y",
"position", 
"right",
"top", 
"visibility", 
"width", 
"z-index", 
"filter",
"cursor", 
*/
"layout-flow",
"scrollbar-3dlight-color",
"scrollbar-arrow-color",
"scrollbar-base-color",
"scrollbar-darkshadow-color",
"scrollbar-face-color",
"scrollbar-highlight-color",
"scrollbar-shadow-color",
"table-layout",

"page",
"page-break-after", 
"page-break-before", 
"text-kashida-space",
"text-justify"
 ]

var styles = ['<style>'];
var htmls = [];

for(var i = 0;i<list.length;i++){
var p = list[i];
styles.push('.c',i,'{',p,':expression(test(this,"',p,'"));color:red}');
htmls.push('<div class="c',i,'">',i,'</div>');
}

styles.push('</style>')
document.write(styles.join(''))

document.write(htmls.join(''))
//alert(document.body.innerHTML)
//alert(styles.join(''))
//alert(htmls.join(''))
</script>
111
</body>
</html>